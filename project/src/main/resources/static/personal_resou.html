<!DOCTYPE html>
<html class="bit-html mobile-false js_active  vc_desktop  vc_transform  vc_transform  csstransforms csstransforms3d csstransitions no-touch" dir="ltr" lang="zh-CN"><!--<![endif]-->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="renderer" content="webkit"> 
	<meta http-equiv="Cache-Control" content="no-transform"> <!-- for baidu -->
    <meta name="MobileOptimized" content="width"><!-- for baidu -->
    <meta name="HandheldFriendly" content="true"><!-- for baidu -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">	
	<title>个人中心</title>
	<link rel="stylesheet" href="./css/herder.css" charset="utf-8">
	<link rel="stylesheet" href="../css/font.css" charset="utf-8">
	<link rel="stylesheet" href="../css/xadmin.css" charset="utf-8">
	<link rel="stylesheet" href="./iconfonts/iconfont.css" charset="utf-8">
	<link rel="stylesheet" href="./css/personal_resou.css" charset="utf-8">
	<script type="text/javascript" src="./js/jquery.min.js"></script>
	<script type="text/javascript" src="../lib/layui/layui.js"  charset="utf-8" ></script>
	<script type="text/javascript" src="../js/xadmin.js"></script>

</head>


<body class="br">
	<div id="header"></div>
	
	<!--正文部分 -->
	<div class="body">
		<div class="navleft">
			<div class="side-nav">
				<div class="person_info">
					<div class="person_img" ><img id="userImgInfo" src=""/></div>
					<div class="person_name" id="personName">name</div>
				</div>
				<ul id="nav">
					<li>
						<i class="iconfont icon-renwu3"></i>
						<a href="javascript:;" class="personalCenter" id="personal_info"><span>个人信息</span></a>
					</li>
					<li>
						<i class="iconfont icon-xiangmu1"></i>
						<a href="javascript:;" class="personalCenter" id="lib_center"><span>资源中心</span></a>
					</li>
					<li>
						<i class="iconfont icon-pinglun"></i>
						<a href="javascript:;" class="personalCenter" id="my_comment"><span>我的评论</span></a>
					</li>
				</ul>
			</div>

		</div>

		<div class="rightblock">
			<div style="width: 100%;height: 20px">我的资源</div>
			<table  border="1">
				<tbody id="orderGoodsList" lay-filter="test"></tbody>
			</table>
		</div>

	</div>
	<div id="footer"></div>

	<script type="text/html" id="download">
		<a class="layui-btn layui-btn-danger layui-btn-mini" lay-event="download">下载</a>
	</script>

<script type="text/javascript" >
	/*加载页头页尾*/
	$(function() {
		$('#header').load('header.html');
		$('#footer').load('footer.html');
	})

	let userId; let userName; let phone; let email; let sex; let img;
	let userSessionInfo = sessionStorage.getItem('userSession');
	if (userSessionInfo != null) {
		userId = JSON.parse(userSessionInfo).userId;
		phone = JSON.parse(userSessionInfo).phone;
		userName = JSON.parse(userSessionInfo).userName;
		email = JSON.parse(userSessionInfo).email;
		sex = JSON.parse(userSessionInfo).sex;
		img = JSON.parse(userSessionInfo).img;
	} else {
		userId = '';
		phone = 0;
		img = '';
	}

	/*我的资料*/
	$("#userName").html(userName);
	$("#userPhone").html(phone);
	$("#myPhone").val(phone);
	$("#userEmail").html(email);
	$("#userSex").html(sex==0?'男':sex==1?'女':'未知');
	$("#personName").html(userName);
	$("#userId").val(userId);
	let userImgInfoSrc = '/user/' + userId + '/' + img;
	setUserImg();

	/*加载图像*/
	function setUserImg() {
		$("#userImgInfo").attr('src', userImgInfoSrc);
	}

	//单击某个元素打开（打开个人信息）
	$("#personal_info").click(function(){
		$(this).css('background','#5B8AC3');
		$(this).siblings().css('background','#8CA6C6');
		window.open('personal.html');
	});
	</script>

	<script>layui.use('laydate',
			function() {
				var laydate = layui.laydate;
				//执行一个laydate实例
				laydate.render({
					elem: '#start' //指定元素
				});
				//执行一个laydate实例
				laydate.render({
					elem: '#end' //指定元素
				});
			});

	layui.use('table',
			function() {
				var table = layui.table;
				//监听表格复选框选择
				table.on('checkbox(test)', function(obj){
					console.log(obj)
				});

				/*let orgId = JSON.parse(sessionStorage.getItem('orgSession')).orgId;*/

				table.render({
					elem: '#orderGoodsList'       /*表格的id选择器*/
					,url: '/order/orderGoodsListByUser'
					//,where: {userId : userId}
					,cols: [[
						{checkbox: true, fixed: true}
						/*,{field:'userName', title:'用户名', width:150, sort: true,}*/
						,{field:'goodsImgmain',title:'商品图片',  width:160,templet:'<div><img src="/image/{{d.goodsId}}/{{d.goodsImgmain}}" /></div>'}
						,{field:'shoppingId', title:'shoppingId', width:100,hide:true }

						,{field:'ordergoodsId',title:'订单号',  width:180, minWidth: 80, sort: true,}
						,{field:'goodsTitle',title:'商品名称',  width:200, minWidth: 80, sort: true,}
						,{field:'developer',title:'商品发行公司',  width:180}
						,{field:'payWay',title:'支付方式',  width:180, sort: true,templet:'#payWay'}
						,{field:'goodsPrice',title:'实付',  width:180, sort: true,templet:'<div>￥{{d.goodsPrice}}</div>'}
						,{field:'pay_data',title:'付款时间',  width:180, sort: true,templet:'<div>{{ layui.util.toDateString(d.createTime, "yyyy-MM-dd HH:mm:ss") }}</div>'}
						,{field:'xiazai',title:'下载资源',  templet: '#download', width:180, minWidth: 80,fixed: 'right' }
						]]
					,id: 'testReload'
					/*,toolbar: '#toolbarDemo'*//*表格头部条*/
					,page: true
				});
			});

	</script>


	<script type="text/html" id="payWay">
		{{#  if(d.payWay=='0'){ }}支付宝
		{{#  }else{ }}微信支付
		{{# } }}
	</script>

</body>
</html>